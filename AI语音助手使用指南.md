# 🤖 智能语音助手使用指南

## 📋 项目概述

智能语音助手是一个集成了DeepSeek大语言模型和Edge TTS语音合成技术的智能对话系统。它提供了完整的语音交互体验，支持文本对话、智能语音朗读、对话历史管理等功能。

## ✨ 核心特性

### 🎯 主要功能
- **智能对话**: 集成DeepSeek大语言模型，支持自然语言对话
- **语音朗读**: 自动将AI回复转换为语音播放
- **双引擎TTS**: 支持Edge TTS和Windows TTS两种语音引擎
- **智能语音选择**: 根据文本语言自动选择合适的语音
- **对话管理**: 完整的对话历史记录、保存和加载功能
- **流式对话**: 支持实时流式对话模式
- **个性化设置**: 丰富的配置选项和个性化设置

### 🔧 技术特性
- **异步处理**: 高性能的异步对话和语音合成
- **模块化设计**: 清晰的模块分离，易于维护和扩展
- **错误处理**: 完善的错误处理和重试机制
- **配置管理**: 灵活的配置系统，支持导入导出
- **虚拟环境**: 完整的虚拟环境支持，依赖隔离

## 🚀 快速开始

### 1. 环境准备

#### 使用虚拟环境（推荐）
```bash
# 激活虚拟环境
activate_env.bat

# 或手动激活
venv\Scripts\activate.bat
```

#### 检查依赖
```bash
# 运行测试脚本
python test_ai_assistant.py
```

### 2. 启动程序
```bash
python ai_voice_assistant.py
```

### 3. 首次配置

程序首次启动时会提示配置DeepSeek API密钥：

1. 点击"⚙️ 设置"按钮
2. 在"🌐 API设置"标签页中输入您的DeepSeek API密钥
3. 可选：调整其他设置（TTS引擎、语音选择等）
4. 点击"💾 保存"

### 4. 开始对话

1. 在输入框中输入您的问题
2. 点击"📤 发送"或按Ctrl+Enter
3. AI将回复您的问题，并自动朗读（如果开启了自动朗读）

## 🎛️ 详细功能说明

### 主界面功能

#### 工具栏
- **🆕 新对话**: 创建新的对话会话
- **📁 加载对话**: 从文件加载对话历史
- **💾 保存对话**: 手动保存当前对话
- **🔊 自动朗读**: 开关自动语音朗读功能
- **⚙️ 设置**: 打开设置对话框
- **ℹ️ 关于**: 显示程序信息

#### 对话区域
- **对话历史列表**: 显示所有历史对话，支持双击加载
- **对话内容显示**: 显示当前对话的完整内容
- **输入框**: 输入您的问题或消息
- **发送按钮**: 发送消息（支持Ctrl+Enter快捷键）

#### 状态栏
- **状态信息**: 显示当前操作状态
- **配置状态**: 显示API和TTS配置状态

### 设置功能

#### 🌐 API设置
- **DeepSeek API密钥**: 必需，用于AI对话功能
- **API基础URL**: 默认为官方地址
- **模型选择**: 支持deepseek-chat和deepseek-coder
- **高级参数**: 最大令牌数、温度、超时时间
- **连接测试**: 验证API配置是否正确

#### 🔊 语音设置
- **TTS引擎**: 选择Edge TTS或Windows TTS
- **语音选择**: 分别配置中文和英文语音
- **语音参数**: 调节语速（0-10）和音量（0-100）
- **自动朗读**: 开关AI回复的自动语音播放
- **语音测试**: 测试当前语音配置

#### 🎨 界面设置
- **字体大小**: 调整界面字体大小（8-24）
- **自动滚动**: 开关自动滚动到最新消息

#### 💬 对话设置
- **系统提示**: 自定义AI的行为和回复风格
- **历史记录**: 设置最大保存的对话数量
- **自动保存**: 开关对话历史的自动保存
- **流式模式**: 开关实时流式对话（实验性功能）

### 对话管理

#### 对话历史
- **自动保存**: 对话会自动保存到conversation_history.json
- **手动保存**: 可通过工具栏手动保存
- **加载对话**: 双击历史列表中的对话即可加载

#### 右键菜单
在对话历史列表中右键点击可以：
- **📖 加载对话**: 加载选中的对话
- **✏️ 重命名**: 修改对话标题
- **📤 导出**: 将对话导出为JSON文件
- **🗑️ 删除**: 删除选中的对话

#### 导入导出
- **导出**: 将对话保存为JSON文件，便于备份和分享
- **导入**: 从JSON文件加载对话历史

## 🎵 语音功能详解

### TTS引擎对比

| 特性 | Edge TTS | Windows TTS |
|------|----------|-------------|
| 语音质量 | ⭐⭐⭐⭐⭐ 神经网络语音 | ⭐⭐⭐ 传统合成语音 |
| 响应速度 | ⭐⭐⭐ 需要网络请求 | ⭐⭐⭐⭐⭐ 本地处理 |
| 语音数量 | ⭐⭐⭐⭐⭐ 数百种语音 | ⭐⭐ 系统内置语音 |
| 网络要求 | ✅ 需要网络连接 | ❌ 无需网络 |
| 支持格式 | MP3 | WAV |

### 智能语音选择

程序会根据文本内容自动选择合适的语音：
- **中文文本**: 自动使用中文语音（如晓晓、云希）
- **英文文本**: 自动使用英文语音（如Jenny、Guy）
- **混合文本**: 根据主要语言选择语音

### 语音控制

- **⏹️ 停止朗读**: 随时停止当前的语音播放
- **语速调节**: 0-10级语速调节
- **音量控制**: 0-100%音量控制
- **自动朗读**: 可开关AI回复的自动朗读

## 🔧 高级功能

### 流式对话模式

启用流式模式后：
- AI回复会实时显示，无需等待完整回复
- 提供更好的交互体验
- 适合长文本回复的场景

### 系统提示自定义

通过自定义系统提示，您可以：
- 定义AI的角色和行为
- 设置回复的语言和风格
- 添加特定的知识背景
- 控制回复的长度和格式

示例系统提示：
```
你是一个专业的编程助手，请用简洁、准确的语言回答编程相关问题。
如果用户使用中文提问，请用中文回答；如果使用英文提问，请用英文回答。
在回答代码问题时，请提供具体的代码示例。
```

### 配置管理

#### 配置文件
- **config.json**: 主配置文件
- **conversation_history.json**: 对话历史文件
- **ai_voice_assistant.log**: 程序日志文件

#### 配置导入导出
- 支持配置的导出和导入
- 便于在不同设备间同步设置
- 敏感信息（如API密钥）会被隐藏

## 🐛 故障排除

### 常见问题

#### Q1: 程序启动失败
**A**: 检查依赖安装
```bash
# 运行测试脚本
python test_ai_assistant.py

# 重新安装依赖
pip install -r requirements_ai.txt
```

#### Q2: API调用失败
**A**: 检查API配置
1. 确认API密钥正确
2. 检查网络连接
3. 使用"🔗 测试连接"功能验证

#### Q3: 语音播放失败
**A**: 检查音频系统
1. 确认音响/耳机连接
2. 检查系统音量设置
3. 尝试切换TTS引擎
4. 运行音频播放器测试

#### Q4: 对话历史丢失
**A**: 检查保存设置
1. 确认"自动保存"已开启
2. 检查文件权限
3. 手动保存对话

#### Q5: 界面显示异常
**A**: 重置设置
1. 在设置中点击"🔄 重置"
2. 或删除config.json文件重新配置

### 日志分析

程序会将详细日志保存到`ai_voice_assistant.log`文件中，包括：
- 系统启动信息
- API调用记录
- 错误和异常信息
- 性能统计数据

### 性能优化

#### 提升响应速度
1. 使用稳定的网络连接
2. 选择合适的API超时时间
3. 关闭不必要的功能（如自动朗读）

#### 减少资源占用
1. 限制对话历史数量
2. 定期清理临时文件
3. 关闭流式模式（如不需要）

## 📚 开发者信息

### 项目结构
```
ai_voice_assistant/
├── ai_voice_assistant.py      # 主程序
├── config_manager.py          # 配置管理
├── conversation_manager.py    # 对话管理
├── deepseek_client.py         # DeepSeek API客户端
├── smart_tts_manager.py       # 智能TTS管理
├── audio_player.py            # 音频播放器
├── test_ai_assistant.py       # 测试脚本
├── config.json                # 配置文件
├── conversation_history.json  # 对话历史
├── requirements_ai.txt        # 依赖列表
└── AI语音助手使用指南.md      # 使用指南
```

### 技术栈
- **GUI框架**: tkinter
- **AI模型**: DeepSeek API (OpenAI SDK)
- **语音合成**: Edge TTS + Windows TTS
- **音频播放**: pygame + playsound
- **异步处理**: asyncio
- **配置管理**: JSON
- **日志记录**: logging

### 扩展开发

程序采用模块化设计，便于扩展：
- 添加新的TTS引擎
- 集成其他AI模型
- 扩展音频播放功能
- 添加新的界面主题

## 🎉 总结

智能语音助手为您提供了完整的AI语音交互体验。通过简单的配置，您就可以享受高质量的AI对话和语音合成服务。

如果您在使用过程中遇到任何问题，请参考故障排除部分或查看日志文件获取详细信息。

**祝您使用愉快！** 🎵
